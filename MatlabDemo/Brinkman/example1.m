function pde=example1
pde = struct('f',@f,'exactu',@exactu,'exactpressure',@exactpressure,'Du',@Du);
    

 function rhs =  f(p,mu)
    x = p(:,1); y = p(:,2); z = p(:,3);
    rhs(:,1) = mu*(2*x.^2.*z.*(5*z - 2).*(x - 1).^2.*(z - 1).^2 +...
               10*x.^2.*y.*(x - 1).^2.*(y - 1).*(z - 1).^2 + ...
               2*x.^2.*y.*(2*z - 2).*(5*z - 2).*(x - 1).^2.*(y - 1)+...
               10*x.^2.*y.*z.*(2*z - 2).*(x - 1).^2.*(y - 1) + ...
               2*x.^2.*y.*z.*(5*z - 2).*(x - 1).^2.*(y - 1) + ...
               2*x.^2.*y.*z.*(5*z - 2).*(y - 1).*(z - 1).^2 +...
               2*y.*z.*(5*z - 2).*(x - 1).^2.*(y - 1).*(z - 1).^2 +...
               4*x.*y.*z.*(2*x - 2).*(5*z - 2).*(y - 1).*(z - 1).^2) -(y - 1/2).*(z - 1);
    rhs(:,2) = -(x - 1/2).*(z - 1) - mu*(2*y.^2.*z.*(5*z - 2).*(y - 1).^2.*(z - 1).^2 +...
              10*x.*y.^2.*(x - 1).*(y - 1).^2.*(z - 1).^2 + 2*x.*y.^2.*(2*z - 2).*(5*z - 2).*(x - 1).*(y - 1).^2 + ...
              10*x.*y.^2.*z.*(2*z - 2).*(x - 1).*(y - 1).^2 + 2*x.*y.^2.*z.*(5*z - 2).*(x - 1).*(y - 1).^2 +...
              2*x.*y.^2.*z.*(5*z - 2).*(x - 1).*(z - 1).^2 + 2*x.*z.*(5*z - 2).*(x - 1).*(y - 1).^2.*(z - 1).^2 +...
              4*x.*y.*z.*(2*y - 2).*(5*z - 2).*(x - 1).*(z - 1).^2);
    rhs(:,3) = -(x - 1/2).*(y - 1/2) - mu*(8*x.*y.*z.^2.*(y - 1).*(z - 1).^3 - ...
              8*x.*y.*z.^2.*(x - 1).*(z - 1).^3 + 8*x.*z.^2.*(x - y).*(x - 1).*(z - 1).^3 +...
              8*y.*z.^2.*(x - y).*(y - 1).*(z - 1).^3 - 8*x.*z.^2.*(x - 1).*(y - 1).*(z - 1).^3 + ...
              8*y.*z.^2.*(x - 1).*(y - 1).*(z - 1).^3 + 8*x.*y.*(x - y).*(x - 1).*(y - 1).*(z - 1).^3 +...
              48*x.*y.*z.*(x - y).*(x - 1).*(y - 1).*(z - 1).^2 + 12*x.*y.*z.^2.*(2*z - 2).*(x - y).*(x - 1).*(y - 1));
 end
function u =  exactu(p)
    x = p(:,1); y = p(:,2);z = p(:,3);
    u(:,1) = -x.^2.*y.*z.*(5*z - 2).*(x - 1).^2.*(y - 1).*(z - 1).^2;
    u(:,2) =  x.*y.^2.*z.*(5*z - 2).*(x - 1).*(y - 1).^2.*(z - 1).^2;
    u(:,3) =  4*x.*y.*z.^2.*(x - y).*(x - 1).*(y - 1).*(z - 1).^3;
end
function pressure =  exactpressure(p)
    x = p(:,1); y = p(:,2);z = p(:,3);
    pressure =  (x-1/2).*(y-1/2).*(1-z);
end

function uprime=Du(p)
    x=p(:,1);y=p(:,2);z = p(:,3);
    uprime(:,1) = -2*x.*y.*z.*(5*z - 2).*(y - 1).*(z - 1).^2.*(2*x.^2 - 3*x + 1);
    uprime(:,2) = y.^2.*z.*(2*x - 1).*(5*z - 2).*(y - 1).^2.*(z - 1).^2;
    uprime(:,3) = -4*y.*z.^2.*(y - 1).*(z - 1).^3.*(2*x - y + 2*x.*y - 3*x.^2);
    uprime(:,4) = -x.^2.*z.*(2*y - 1).*(5*z - 2).*(x - 1).^2.*(z - 1).^2;
    uprime(:,5) = 2*x.*y.*z.*(5*z - 2).*(x - 1).*(z - 1).^2.*(2*y.^2 - 3*y + 1);
    uprime(:,6) = -4*x.*z.^2.*(x - 1).*(z - 1).^3.*(x - 2*y - 2*x.*y + 3*y.^2);
    uprime(:,7) = -2*x.^2.*y.*(x - 1).^2.*(y - 1).*(10*z.^3 - 18*z.^2 + 9*z - 1);
    uprime(:,8) = 2*x.*y.^2.*(x - 1).*(y - 1).^2.*(10*z.^3 - 18*z.^2 + 9*z - 1);
    uprime(:,9) = 4*x.*y.*z.*(5*z - 2).*(x - y).*(x - 1).*(y - 1).*(z - 1).^2;
end
end